# Windows命令行

所有受支持的Windows和Windows Server版本都内置了一组Win32控制台命令行。Windows提供了两个命令行：Command shell和PowerShell。

Command shell是Windows中内置的第一个shell，用于自动执行常规任务（例如用户帐户管理或夜间备份），其中包含批处理（.bat）文件。PowerShell旨在扩展Command shell的功能，运行名为cmdlet的PowerShell命令。Cmdlet类似于Windows命令，但提供了更可扩展的脚本语言。可以在PowerShell中同时运行Windows命令和cmdlet，但Command shell只能运行Windows命令。

## 常用命令

`help`命令显示可用命令的列表或指定命令的详细帮助信息，语法为`help [<command>]`。`/?`参数用于显示命令的帮助及用法，如`cd /?`显示`cd`帮助及用法、`dir /?`显示`dir`帮助及用法。

`cd`或`chdir`命令即Change Directory，用于切换路径，可添加驱动器盘符、完整路径或相对路径实现路径的切换，语法为`cd [/d] [<drive>:\][<path>]`

- 回到根目录：`cd /`
- 回到上一层目录：`cd ..`
- `\d`表示更改当前驱动器以及驱动器的当前目录，当切换到其他驱动器路径时需要此参数。

`dir`命令可以查看当前目录下的文件和子目录，语法为`dir [<drive>:\][<path>][<filename>] [/a[:]<attributes>] [/b] [/c] [/d] [/l] [/n] [/o[[:]<sortorder>]] [/p] [/q] [/r] [/s] [/t[[:]<timefield>]] [/w] [/x] [/4]`。

- `[<drive>:\][<path>][<filename>]`：指定要列出的驱动器、目录和/或文件。
- `/a`：根据以下文件属性显示文件：
- - `d`：目录。
- - `r`：只读文件。
- - `h`：隐藏文件。
- - `i`：无内容索引文件。
- - `o`：脱机文件。
- - `s`：系统文件。
- - `a`：准备归档的文件。
- - `l`：重新分析点。
- - `-`：表示“否”的前缀。
- `/p`：一次显示一个屏幕，按任意键查看下一个屏幕。
- `/q`：显示文件所有者。
- `/w`：以宽格式显示列表，每行上有多达五个文件名或目录名。
- `/d`：以与`/w`相同的格式显示列表，但文件按列排序。
- `/b`：显示目录和文件的裸列表，不包含其他信息。`/b`参数覆盖`/w`。
- `/c`：在文件大小中显示千位数分隔符，默认。使用`/-c`隐藏。
- `/l`：使用小写字母显示未排序的目录名和文件名。
- `/n`：在屏幕最右边显示文件名的长列表格式。
- `/o`：按顺序列出文件：
- - `n`：按名称（字母顺序）。
- - `e`：按扩展名（字母顺序）。
- - `g`：组目录优先。
- - `s`：按大小（从小到大）。
- - `d`：按日期/时间（从先到后）。
- - `-`：表示“否”的前缀。
- `/r`：显示文件的备用数据流。
- `/s`：列出指定文件名在指定目录和所有子目录中的每次出现。
- `/x`：显示为非8dot3文件名生成的短名称。显示与显示`/n`相同，但将短名称插入到长名称之前。
- `/4`：以四位数格式显示年份。

`cls`命令可以清除命令行窗口，语法为`cls`。

`md`或`mkdir`命令可以创建目录或子目录，语法为`md [<drive>:\]<path>`。

- 在当前文件夹下创建目录：`md <path>`。
- 在根目录下创建目录：`md \<path>`。
- 在指定路径下创建目录：`md [<drive>:\]<path>`。

`rd`或`rmdir`命令用于删除目录，不能删除非空目录和当前目录，语法为`rd [<drive>:\]<path> [/s [/q]]`。

- 删除当前文件夹下的目录：`rd <path>`。
- 删除根目录下的目录：`rd \<path>`。
- 删除指定路径下的目录：`rd [<drive>:\]<path>`。
- `/s`：删除目录树，包含指定目录和其下所有子目录与文件。
- `/q`：静默模式，不提示确认，只有指定了`/s`后才有效。

`del`或`erase`命令用于删除一个或多个文件，语法为`del [/p] [/f] [/s] [/q] [/a[:]<attributes>] <names>`，删除后将无法找回。

- `<names>`指定了要删除的文件名列表，使用通配符"*"时会删除匹配到的所有文件。如果指定了目录，将删除该目录下的所有文件。
- `/p`：删除每个文件前提示确认。
- `/f`：强制删除只读文件。
- `/s`：从当前目录和所有子目录中删除指定文件。
- `/q`：静默模式，使用通配符时不提示确认。
- `/a`：根据以下文件属性删除文件：
- - `r`：只读文件。
- - `h`：隐藏文件。
- - `i`：无内容索引文件。
- - `o`：脱机文件。
- - `s`：系统文件。
- - `a`：准备归档的文件。
- - `l`：重新分析点。
- - `-`：表示“否”的前缀。

`copy`命令用于将一个或多个文件从一个位置复制到另一个位置，语法为`copy [/d] [/v] [/n] [/y | /-y] [/z] [/a | /b] <source> [/a | /b] [+<source> [/a | /b] [+ ...]] [<destination> [/a | /b]]`。

- `/d`：允许将正在复制的加密文件保存为目标位置的加密文件。
- `/v`：验证新文件是否被正确写入。
- `/n`：当复制文件名长于8个字符或扩展名长于3个字符的文件时，如果可用，则使用短文件名。
- `/y`：不显示确认要覆盖现有目标文件的提示。
- `/-y`：显示确认要覆盖现有目标文件的提示，默认。批处理时不显示。
- `/z`：以可重启模式复制网络文件。
- `/a`：表示ASCII文本文件。
- `/b`：二进制文件。
- `<soruce>`：必须，指定要从中复制文件或文件集的位置，可以由驱动器号和冒号、目录名、文件名或这些的组合组成。
- `<destination>`：必须，指定目标位置，可以由驱动器号和冒号、目录名、文件名或这些的组合组成。

`move`命令用于将一个或多个文件从一个目录移动到另一个目录，语法为`move [{/y|-y}] [<source>] [<target>]`。

- `/y`：不显示确认要覆盖现有目标文件的提示。
- `/-y`：显示确认要覆盖现有目标文件的提示，默认。批处理时不显示。
- `<soruce>`：指定要移动的文件的路径和名称。要移动或重命名目录，源文件应该是当前目录的路径和名称。
- `<target>`：指定要移动文件的路径和名称。要移动或重命名目录，目标应该是所需的目录路径和名称。

`ipconfig`命令会显示所有当前TCP/IP网络配置值，并刷新DHCP（Dynamic Host configuration Protocol）和DNS（Domain Name System）设置，语法为`ipconfig [/allcompartments] [/all] [/renew [<adapter>]] [/release [<adapter>]] [/renew6[<adapter>]] [/release6 [<adapter>]] [/flushdns] [/displaydns] [/registerdns] [/showclassid <adapter>] [/setclassid <adapter> [<classID>]]`。当不带参数时，`ipconfig`显示所有适配器的IPv4和IPv6地址、子网掩码和默认网关。

`ping`命令通过发送ICMP（Internet Control Message Protocol）回显请求消息来验证与另一台TCP/IP计算机的IP级连通性。将显示相应的echo Reply消息的接收以及往返时间。`ping`是主要的TCP/IP命令，用于排除连通性、可达性和名称解析问题，语法为`ping [/t] [/a] [/n <count>] [/l <size>] [/f] [/I <TTL>] [/v <TOS>] [/r <count>] [/s <count>] [{/j <hostlist> | /k <hostlist>}] [/w <timeout>] [/R] [/S <Srcaddr>] [/4] [/6] <targetname>`。
