# 格式化字符串

用于控制格式化字符串占位符对应的值的格式、对齐方式和间距。`String.Format()`可以复合设置格式。

## 索引占位符

格式项是格式化字符串时的待替换项，也称索引占位符。在格式化输出字符串时，每个格式项都替换为参数列表中相应索引（从0开始）处的参数的字符串表示形式。如果参数的值为`null`，则将格式项替换为`String.Empty`。如果要插入的对象不是字符串，则调用它的`ToString`方法将其转换为一个字符串，然后再将其插入到结果字符串中。

``` C#
// 语法
{index[,alignment][:formatString]}
```

`index`是自变量从0开始的索引。`{index}`表示将在此位置插入参数列表中对应的参数的字符串值。如果此参数的值为`null`，则将替换为`String.Empty`。只要每个格式项的索引在对象列表中都有匹配的对象，就可以拥有任意数量的格式项以及对象列表中的任意多个对象。

``` C#
string s = String.Format("At {0}, the temperature is {1}°C.", DateTime.Now, 20.4);
// s为 "At 4/10/2015 9:29:41 AM, the temperature is 20.4°C."
```

方括号表示可选元素。在添加可选元素时，不加`[]`。

其中`[,alignment]`表示结果中的字符串总长度，并指定是右对齐（正数）还是左对齐（负数）。如果省略`[,alignment]`，则插入相应参数的字符串表示形式时不会增加空格。如果要插入的参数长度大于总长度，则将忽略则将忽略宽度限制，将整个字符串插入到结果中。

``` C#
Console.WriteLine(String.Format("{0,6} {1,15}\n\n", "Year", "Population"));
Console.WriteLine(String.Format("{0,6} {1,15:N0}\n", 2013, 1025632));
// Output:
//   Year     Population
//   2013        1025632
```

`[:formatString]`指定相应参数的字符串表示形式的格式。如果省略`[:formatString]`，则将调用相应的参数的无参`ToString`方法生成其字符串表示形式。如果指定格式，则该格式项引用的参数必须实现`IFormattable`接口。

支持格式字符串的类型包括：所有整型和浮点类型；`DateTime`和`DateTimeOffset`；所有枚举类型；`TimeSpan`值；GUID；任何可以实现`IFormattable`或扩展现有类型的`IFormattable`实现的自定义类型。

``` C#
string s = String.Format("It is now {0:d} at {0:t}", DateTime.Now);
// s为 "It is now 4/10/2015 at 10:04 AM"
```

## 标准格式说明符

下面描述标准的数字格式说明符并显示由每个格式说明符产生的示例输出。特定区域性的格式化字符串的结果可能与以下示例不同。操作系统设置、用户设置、环境变量和所用的.NET版本都会影响格式。

- `C`或`c`：货币，精度说明符指定小数位数，默认为2。支持所有数值类型。如果要设置格式的值的小数位数多于指定或默认数量，将在结果字符串中舍入小数值。 如果指定的小数位数右侧的值大于或等于 5，则结果字符串中的最后一位数将向远离零的一侧舍入。
- `D`或`d`：十进制整型数字，精度说明符指定最小有效位数，不足时以0填充高位，默认为整数本身位数。支持所有整型类型，支持正负。
- `E`或`e`：科学记数，精度说明符指定小数位数，默认为6。支持所有数值类型，支持正负。格式说明符的大小写指示为指数加前缀`E`还是`e`。指数总是由正号或负号以及最少三位数字组成，不足时以0填充高位。
- `F`或`f`：小数，精度说明符指定小数位数，默认为2。支持所有数值类型，支持正负。
- `G`或`g`：更紧凑的小数或科学记数，精度说明符指定结果的最大有效位数，默认值取决于数据类型。支持所有数值类型，支持正负。
- `N`或`n`：显示分隔符的数字，精度说明符指定小数位数，默认为2。支持所有数值类型，支持正负。
- `P`或`p`：百分比，精度说明符指定小数位数，默认为2。支持所有数值类型，支持正负。
- `X`或`x`：十六进制整数，精度说明符指定最小有效位数，不足时以0填充高位，默认为整数本身位数。支持所有整型类型，支持正负。格式说明符的大小写指示对大于9的十六进制数使用大写字符还是小写字符。

下面描述了标准日期和时间格式说明符。

- `d`/`D`：短/长日期模式。
- `t`/`T`：短/长时间模式。
- `f`/`F`：完整日期加短/长时间模式。
- `g`/`G`：常规日期加短/长时间模式。
- `m`、`M`：月/日模式。
- `y`、`Y`：年月模式。
- `o`、`O`：往返日期/时间模式。
- `r`、`R`：RFC1123模式。
- `s`：可排序时间模式。
- `u`：通用可排序日期/时间模式，为`yyyy'-'MM'-'dd HH':'mm':'ss'Z'`。
- `U`：通用完整日期/时间模式。

下表描述自定义日期和时间格式说明符。

- `s`/`ss`：按一/两位显示的秒。
- `m`/`mm`：按一/两位显示的分钟。
- `h`/`hh`或`H`/`HH`：十二时或二十四小制的按一/两位显示的小时。
- `:`：时间分割符。
- `t`/`tt`：按一/两位显示的AM/PM指示符。
- `K`：时区信息。
- `d`/`dd`：按一/两位显示的天。
- `ddd`/`dddd`：一周中某天的缩写/全写名称。
- `M`/`MM`：按一/两位显示的月份。
- `MMM`/`MMMM`：月份的缩写/全写名称。
- `y`/`yy`/`yyy`/`yyyy`/`yyyyy`：按一/两/三/四/五位显示的年份。
- `/`：日期分割符。
- `g`或`G`：时期或纪元。
- `f`/`ff`/`fff`/`ffff`/`fffff`/`ffffff`/`fffffff`：日期和时间值的十/百/千/万/十万/百万/千万分之几秒。
- `F`/`FF`/`FFF`/`FFFF`/`FFFFF`/`FFFFFF`/`FFFFFFF`：如果非零，则为日期和时间值的十/百/千/万/十万/百万/千万分之几秒。