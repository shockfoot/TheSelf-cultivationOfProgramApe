# LC2444统计定界子数组的数目

难度：中等
数据结构：数组
算法：暴力枚举、三指针

## 题目

给定一个整数数组nums和两个整数minK以及maxK。

nums的**定界子数组**是满足下述条件的一个子数组：

- 子数组中的**最小值**等于minK。
- 子数组中的**最大值**等于maxK。

返回定界子数组的数目。

> 子数组是数组中的一个连续部分。

示例：

> 输入：nums = [1,1,1,1], minK = 1, maxK = 1
> 输出：10
> 解释：nums的每个子数组都是一个定界子数组。共有10个子数组。

提示：

- 2 <= nums.length <= 10^5^
- 1 <= nums[i], minK, maxK <= 10^6^

## 题解

### 暴力枚举

用暴力枚举的方法，即双层循环枚举所有子数组。因为提示中数据量比较大，会超时。

``` csharp
public long CountSubarrays(int[] nums, int minK, int maxK)
{
    if (nums is not { Length: > 0 })
    {
        return 0;
    }

    int n = nums.Length, max = 0, min = 0;
    long result = 0;
    for (int i = 0; i < n; i++)
    {
        max = 0;
        min = int.MaxValue;
        for (int j = i; j < n; j++)
        {
            if (max < nums[j])
            {
                max = nums[j];
            }
            if (min > nums[j])
            {
                min = nums[j];
            }
            if (min < minK || max > maxK)
            {
                break;
            }
            if (min == minK && max == maxK)
            {
                result++;
            }
        }
    }

    return result;
}
```

时间复杂度：时间复杂度为O(n^2^)，n为数组长度。

空间复杂度：空间复杂度为O(1)。

### 三指针

可以发现，定界子数组不含有小于minK和大于maxK的元素，因此可以使用minK和maxK将数组muns分段，只需要计算每个段内的子数组的数量即可。所以，可以在一次遍历中使用双指针定位段。

当然，段和段之间的边界需要一个额外指针定位。此时，该段内满足题意的定界子数组数量即为min(left, right) - border。

``` csharp
public long CountSubarrays(int[] nums, int minK, int maxK)
{
    if (nums is not { Length: > 0 })
    {
        return 0;
    }

    int n = nums.Length, border = -1, lastMax = -1, lastMin = -1;
    long result = 0;
    for (int i = 0; i < n; i++)
    {
        if (nums[i] < minK || nums[i] > maxK)
        {
            border = i;
            lastMax = -1;
            lastMin = -1;
        }
        if (nums[i] == minK)
        {
            lastMin = i;
        }
        if (nums[i] == maxK)
        {
            lastMax = i;
        }
        if (lastMin != -1 && lastMax != -1)
        {
            result += Math.Min(lastMax, lastMin) - border;
        }
    }

    return result;
}
```

时间复杂度：时间复杂度为O(n)，n为数组长度。

空间复杂度：空间复杂度为O(1)。