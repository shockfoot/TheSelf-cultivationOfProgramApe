# 计算机组成与体系结构

## 存储

计算机中最小的存储单位为“位”（bit），1byte（字节） = 8bit，1KB（千字节） = 1024byte，1MB（兆字节） = 1024KB，1GB（吉字节） = 1024MB，1TB（太字节） = 1024GB。

## 进制

进制有二进制（B）、八进制（O）、十进制（D）、十六进制（H）。

| 次数 | 2 | 8 | 10 | 16 |
| --- | --- | --- | --- | --- |
| 0  | 1 | 1 | 1 | 1 |
| 1  | 2 | 8 | 10 | 256 |
| 2  | 4 | 64 | 100 | 4096 |
| 3  | 8 | 512 | 1000 |  |
| 4  | 16 | 4096 | 10000 |  |
| 5  | 32 |  |  |  |
| 6 | 64 |  |  |  |
| 7 | 128 |  |  |  |
| 8 | 256 |  |  |  |
| 9 | 512 |  |  |  |
| 10 | 1024 |  |  |  |

> **注意**：计算机中一切数据，如数字、汉字、图片、声音、视频、指令等都用二进制表示和传输。
> **ASCII**：美国信息交换标准代码。一般使用7位二进制数表示字母、数字、标点符号及部分特殊控制字符。

其他进制转换为十进制：**按权求和**（将R进制数的每一位数值用R^k^形式表示，其中R为底数，k为指数，k与该位和小数点之间的距离有关。位于小数点左边，k值是该位和小数点之间数码的个数；位于小数点右边，k值为负，其绝对值是该位与小数点之间数码的个数加1）。

公式：R进制数X~n-1~...X~0~.X~-1~...X~-m~ = X~n-1~R^n-1^ + ... + X~0~R^0^ + X~-1~R^-1^ + ... + X~-m~R^-m^。

十进制转换为其他进制：**短除法**，即**除基倒取余**（将该数值除以指定基数，然后倒序排列余数），或者**按权展开**（将其他进制的数值转换为该进制基数个次数的和的形式）。

> 除基倒取余：94转二进制：47余0，23余1，11余1，5余1，2余1，1余0，0余1，所以为1011110B。
> 按权展开：94转二进制：2^6^ + 2^4^ + 2^3^ + 2^2^ + 2^1^，所以为1011110B。

十进制小数转换为其他进制：**乘基正整法**。

> 0.875转二进制：0.875乘2得1.75取1，0.75乘2得1.5取1，0.5乘2得1取1，即0.111B。

二进制转八/十六进制：将三/四位转为一位八/十六进制数。**小数点前不足的在高位补0，小数点后不足在末尾补0。**

> 八四二一。

八/十六进制转二进制：将一位八/十六进制数转换为三/四位二进制数。

八进制与十六进制之间的转换：基于二进制。

## 码制

| 码制 | 正数 | 负数 | 运算规则 |
| --- | --- | --- | --- |
| 原码 | 0110 0010 | 1110 0010 | 最高位为符号位，符号位0表示正，1表示负。 |
| 反码 | 0110 0010 | 1001 1101 | 在原码基础上，正数不变，负数除符号位不变其余位按位取反。 |
| 补码 | 0110 0010 | 1001 1110 | 在反码基础上，正数不变，负数加1。 |
| 移码 | 1110 0010 | 0001 1110 | 在补码基础上，将符号位按位取反。 |

**正数的原码、反码、补码相同。补码的补码是原码。**

### ±0的表示

| 码制 | 数值0 | 数值-0 | 0-0 |
| --- | --- | --- | --- |
| 原码 | 0000 0000 | 1000 0000 | 1000 0000 |
| 反码 | 0000 0000 | 1111 1111 | 1111 1111 |
| 补码 | 0000 0000 | 0000 0000 | 0000 0000 |
| 移码 | 1000 0000 | 1000 0000 | 0000 0000 |

> **注意**：±0仅在补码和移码中有唯一标识方式。
> 多数计算机都采用补码的加法器进行加减运算，其符号位和数值位一样参与运算，无需做特殊处理。其中减法会转化为加法进行运算。

### 整数的表示

| 码制 | 定点整数 |
| --- | --- |
| 原码 | -(2^n-1^-1) ~ +(2^n-1^-1) |
| 反码 | -(2^n-1^-1) ~ +(2^n-1^-1) |
| 补码 | -2^n-1^ ~ +(2^n-1^-1) |
| 移码 | -2^n-1^ ~ +(2^n-1^-1) |

> **注意**：由于补码和移码中±0仅在有唯一标识方式，因此移码和补码可以多表示一个数，即规定补码10000000B和移码00000000B表示-128。

### 浮点数的表示

两种表示方式：

- N = 尾数\*基数^指数^
- N = 数符\*尾数m\*2^阶符\*阶码e^，其中数符是尾数的符号，阶符是阶码的符号。

**阶码的为数决定数的表示范围，位数越多范围越大。尾数的位数决定数的有效精度，位数越多精度越高。**

两浮点数加减运算过程：

1. 对阶：小数向大数看齐，对阶时小数的尾数右移。
2. 尾数计算。
3. 结果格式化（整数以01开头，负数以10开头）。

根据浮点数对阶，可以快速将小数转换为二进制数：

1. 将小数转化为分数形式（分母可以转化为2^n^形式）。
2. 分子转为二进制，分母转为2^n^形式。
3. 分母转为2^0^，分子移位。
4. 添加符号位（小数点前1位为符号位），补足位数（小数部分末尾补0）。

> 将-0.578125转化为八位定点机器码：-0.578125为-37/64，-37/64可以转化为100101B\*2^-6^；将分子向右移6位即0.100101B，最终结果为1.1001010B。

## 逻辑运算

### 逻辑运算规则

逻辑变量之间的运算称为逻辑运算。二进制数1和0在逻辑上可以代表真与假。

- 逻辑或（||、+、∪、v、OR）：有一个值为真即为真。
- 逻辑与（&&、\*、·、∩、\^、AND）：两个值全为真时才为真。
- 逻辑非（!、~、NOT）：原值取反。
- 逻辑异或/半加（\^、XOR）：两个值不同时才为真。

运算优先级：逻辑非 > 逻辑与 > 逻辑或/异或，同级自左向右，括号优先计算。

逻辑运算可以**短路**。

### 真值表

真值表是描述一个表达式与其变量之间的关系。

| A | B | !A | A+B | A*B | A^B |
| --- | --- | --- | --- | --- | --- |
| 0 | 0 | 1 | 0 | 0 | 0 |
| 0 | 1 | 1 | 1 | 0 | 1 |
| 1 | 0 | 0 | 1 | 0 | 1 |
| 1 | 1 | 0 | 1 | 1 | 0 |

## 校验码

### 奇偶校验

校验码由若干有效信息（如一个字节），再加上一个二进制位（校验位）组成。校验位用于补0或1以满足奇偶校验的规则。

**奇校验**：整个校验码（有效信息位和校验位）中“1”的个数为奇数。

**偶校验**：整个校验码（有效信息位和校验位）中“1”的个数为偶数。

> 如数据1011001，“1”的个数为4，奇校验时校验位补1为11011001以满足奇校验；偶校验时校验位补0为01011001以不破坏偶校验。当接收到的数据校验出错时，无法得知具体出错的位置。

**奇偶校验只能检查出现奇数个位出现的错误，不可纠错。如果是偶数个位出现错误则发现不了。**

### 海明码

**海明码也是利用奇偶性进行检错和纠错。** 在数据为之间插入K个校验位，通过扩大码距来实现检错和纠错。校验位设置在2^i^的位置前。其位置关系存在规律2^P^ ≥ P + D + 1，其中P为海明码个数，D为数据位个数。

> 如数据1011001，在第2^0^、2^1^、2^2^、2^3^位之前插入校验码。

### 循环冗余校验码

**循环冗余校验码也叫CRC码，只能检错，无法纠错。** (n,k)码，信息码占坐标k位，校验码占右边n-k位，校验码数越长，校验能力越强。在求CRC编码时，采用**模二运算**。

## 计算机分类

按计算机体积和工作能力分类：

- 个人移动设备：带有多媒体用户界面的无线设备，如智能手机、平板电脑。
- 桌面计算机：基于超大规模集成电路技术的CPU，如笔记本、台式机和高配置工作站。
- 服务器：提供大规模可靠的文件及计算机服务。
- 集群/仓库级计算机：集群机将一组桌面计算机或服务器用网络连接在一起，运行方式类似于一个大型计算机。仓库级计算机将数万个服务器连接在一起形成大规模集群。
- 超级计算机：与个人计算机无太大差异，但规格高、性能强大，具有很强计算能力，但能耗巨大。
- 嵌入式计算机：专用的，针对于某个具体特定的应用，如微波炉、洗衣机、数码产品等。

按指令系统划分：

| 指令系统类型 | 指令 | 寻址方式 | 实现方式 | 其它 |
| --- | --- | --- | --- | --- |
| 复杂指令计算机（Complex Instruction Set Computer，CISC） | 指令数量多，使用频率差别大，可变长格式 | 支持多种寻址方式 | 使用微程序控制技术（微码） | 研制周期长 |
| 精简指令计算机（Reduced Instruction Set Computer，RISC） | 指令数量少，使用频率接近，可定长格式，大部分为单周期指令，操作寄存器，只有Load/Store操作内存 | 支持寻址方式少 | 增加了通用寄存器；硬布线逻辑控制为主；适合采用流水线 | 优化编译，有效支持高级语言 |

## 计算机系统组成

计算机由硬件和软件组成，其中硬件包括中央处理器、内存储器、外存储器、输入设备、输出设备等，软件包括系统软件（操作系统、语言处理程序、数据库管理系统等）、中间件、应用软件。

### 中央处理器

**中央处理器（Central Processing Unit，CPU）主要用于指令控制、操作控制、时序控制和数据处理，包括运算器和控制器。**

**运算器接收从控制器传来的命令并执行相应的动作，对数据进行加工和处理**：

- **算数逻辑单元ALU**：数据的算数运算和逻辑运算。
- **累加寄存器AC（数据寄存器）**：用于暂存操作数和中间运算结果并向ALU提供运算对象。
- 状态字寄存器PSW（标志寄存器）：存状态标志与控制标志。
- 通用寄存器组：用于暂存操作数或数据的地址。

**控制器负责指挥和协调整个CPU工作的核心部分，控制指令的执行和数据的传输**：

- **程序计数器PC**：存储下一条要执行指令的内存地址，每取出一条指令，PC内容自动加1。
- **指令寄存器IR**：存放正在执行的指令。
- 指令译码器ID：对现行指令进行分析，确定指令类型和其所要完成的操作以及寻址方式。
- 时序部件：用于产生时序脉冲和节拍电位。
- 状态字寄存器PSW（标志寄存器）：保存指令执行完成后产生的条件码。

### 指令系统

指令执行方式：取指、分析、执行。

流水线技术：将一个重复的时序过程，分解成若干个子过程，每个过程都可有效地在其专用功能段上与其他子过程同时执行。如某指令在分析时，同时进行下一指令的取指；某指令在执行时，同时进行下一指令的分析。

通常用百万条指令/秒（Million Instruction Per Second，MIPS）表示计算机的运行速度。计算机的字长越长，处理能力越强。

一条指令就是机器语言的一个语句，它是一组有意义的二进制代码，包括操作码字段和地址码字段。

操**作码部分指出了计算机要执行什么性质的操作，如加法、减法、取数、存数等。地址码字段需要包含各操作数的地址及操作结果的存放地址等**，从其地址结构的角度可分为三地址指令、二地址指令、一地址指令和零地址指令。

**寻址方式**：

- 立即寻址方式：操作数直接在指令中，速度快，灵活性差。
- 直接寻址方式：指令中存放的是操作数的地址。
- 间接寻址方式：指令中存放了一个地址，这个地址对应的内容是操作数的地址。
- 寄存器寻址方式：寄存器存放操作数。
- 寄存器间接寻址方式：寄存器存放操作数的地址。
